/**************************************
 @Name: jQuery-Validator 基于jQuery的表单验证框架
 @Version: 1.3.0 beta
 @Author: Ready
 @Blog: http://www.365mini.com
 @Copyright: CodePlayer( Ready )
 @Email: CodePlayer360@gmail.com
 @Licence: https://www.apache.org/licenses/LICENSE-2.0.html
*/
!function(a,b){var d,e,f,g,c=b&&b.console;return"undefined"==typeof jQuery||a!==jQuery?(c&&c.log("jQuery must be initialied before loading the Validator."),void 0):(d=function(b){if(!(this instanceof d))return new d(b);if(b||(b="v"),!a.fn[b]){var c=this;a.fn[b]=function(a,b){return c.execute(this,a,b)}}},e=d.cache={},f=d.log=function(){if(c){for(var a=0;a<arguments.length;a++)c.log(arguments[a]);return!0}},g=d.fn=d.prototype={version:"1.3",constructor:d,getValue:function(a){return a.val()},strict:!0,$:function(b,c){if(!b)return null;if(b instanceof a)return b;if("string"===a.type(b)){var d=b.charAt(0);"#"!=d&&("$"==d&&(b=b.substr(1)),b="[name='"+b+"']")}return a(b,c)},defaultRules:{required:!0},extendRule:function(b,c,d){for(var g,e=b?a.extend({},c):c,f=c.extend;f;){if(g=this.getRule(f),!g)throw"extended rule not found:"+f;for(i in g)i in e||(e[i]=g[i]);f=g.extend}if(d)for(i in d)i in e||(e[i]=d[i]);return e.extend&&delete e.extend,e},clipRule:function(a){return this.extendRule(!0,a,this.defaultRules)},pre:{trim:function(b){return a.trim(b)},trimAll:function(a){return e.__whiteSpace||(e.__whiteSpace=/\s/g),a?a.replace(e.__whiteSpace,""):a},lower:function(a){return a?a.toLowerCase():a},upper:function(a){return a?a.toUpperCase():a},flush:function(a,b){return b.$dom&&b.$dom.val(a),a}},formatter:{number:function(a,b,c){var h,i,j,k,g=e[c.rule.format];if(!g){switch(b||(b="+int"),h=b.charAt(0),i="",h){case"+":break;case"-":i="-";break;case"?":i="-?";break;default:h="+",b=h+b}switch(j=b.substr(1)){case"int":case"integer":g=new RegExp("^"+i+"\\d+$");break;case"money":g=new RegExp("^"+i+"\\d+(\\.\\d{1,2})?$");break;case"float":case"double":g=new RegExp("^"+i+"\\d+(\\.\\d+)?$");break;default:k=j.split(".",2),g="^"+i+"\\d"+k[0],k[1]&&(g+="\\.\\d"+k[1]),g=new RegExp(g+"$")}e[c.rule.format]=g}return d.debug&&f("number formatter ["+b+"] regexp:",g),g.test(a)?parseFloat(a):!1},date:function(a,b,c){var h,g,i,j,k,l,m;if(b?"datetime"==b?b="yyyy-MM-dd HH:mm:ss":"time"==b&&(b="HH:mm:ss"):b="yyyy-MM-dd",!a||a.length!=b.length)return!1;if(g=e[c.rule.format],!g){for(i=e.__date||(e.__date=new RegExp("yyyy|MM|dd|HH|mm|ss","g")),g={},i.lastIndex=0;h=i.exec(b);)g[h[0]]=[h.index,h.index+h[0].length];e[c.rule.format]=g}d.debug&&f("date pattern:",g),j={},k=a.split("");for(l in g){for(h=g[l],m=h[0];m<h[1];m++)k[m]=!0;if(h=a.substring(h[0],h[1]),j[l]=parseInt(h,10),j[l]!=h)return!1}for(l in k)if(k[l]!==!0&&k[l]!==b[l])return!1;return j.MM&&j.MM--,c.date=new Date(j.yyyy,j.MM||0,j.dd||1,j.HH||0,j.mm||0,j.ss||0)},idcard:function(a,b,c){var h,i,j,k,l,m,n,o,p,q,r,g=e[c.rule.format];if(g||(g=b?b.split(":",2):["?"],1==g.length&&g[0].length>2&&(g=["?",g[0]]),e[c.rule.format]=g),d.debug&&f("idcard pattern:",g),!a||"?"==g[0]&&15!=a.length&&18!=a.length||a.length!=g[0])return!1;if(h=18==a.length){for(i=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],j=0,k=0;k<i.length;k++)j+=a.charAt(k)*i[k];if(isNaN(j)||a.charAt(17)!="10X98765432".charAt(j%11))return!1}if(l=6,m=a.substring(l,l+=h?4:2),n=a.substring(l,l+=2),o=a.substring(l,l+=2),h||(m="19"+m),n--,p=c.actual=new Date(m,n,o),isNaN(p.getTime()))return!1;if(g[1]){if(q=new Date,p.getTime()>q.getTime())return!1;if(r=q.getFullYear()-p.getFullYear(),q.setFullYear(q.getFullYear()-r),p.getTime()>q.getTime()&&r--,this.validator.range.call(this,r,c)===!1)return!1}return c.birthday=p}},validator:{required:function(a,b,c){var e,f,d=c.$dom;if(d&&d.length&&(f=d[0],f.nodeName,null==f.checked||"checkbox"!=f.type&&"radio"!=f.type||(e=!0,c.actual=a=d.filter(":checked").length)),!a){if(c.rule.required)return this.sendError(e?"checked":"",a,"required",c),!1;c._stop=!0}},format:function(a,b,c){var e=d.util.parseFormat(b),f=this.formatter[e[0]];if(f)return a=f.call(this,a,e[1],c),a===!1&&this.sendError(b,a,e[1],c),a;throw"Unsupported format validator:"+e[0]},text:function(b,c,d){var e=a.type(c);switch(e){case"string":if(c!=b)return this.sendError("==",b,c,d),!1;break;case"regexp":if(!c.test(b))return this.sendError("regexp",b,c,d),!1;break;case"function":if(c.call(this,b,d)===!1)return this.sendError("function",b,c,d),!1;break;default:throw"Unexpected text validator:"+c}},length:function(a,b,c){return this.validator.range.call(this,c.value.length,b,c)},range:function(a,b,c){var f,g,e=d.util.parseIntervalPattern(b);if(e.equals){if(a!=e.min)return this.sendError("==",a,e.min,c),!1}else{if(e.min&&(f=a>e.min||">="==e.left&&e.min==a,!f))return this.sendError(e.left,a,e.min,c),f;if(e.max&&(g=a<e.max||"<="==e.right&&e.max==a,!g))return this.sendError(e.right,a,e.max,c),g}},equalsTo:function(a,b,c){var e=this.$(b),f=this.getValue(e,c);return a!=f?(d.util.pushDomContext(null,e,c),this.sendError("",a,f,c),!1):void 0},compare:function(b,c,g){var k,h={},i=g.rule,j=this,l=!0,m=c.replace(e.__compare||(e.__compare=/\b(this|now)\b|([$#])([^\s=+*\/%&|-]+)/g),function(c,e,f,m){var o,p,q,r,n=e||m;return l&&("this"==n?null==h[n]&&(h[n]=b):"now"==n?null==h[n]&&(h[n]=new Date):(o="#"==f?"#"+n:"[name='"+n+"']",p=a(o),q=j.getValue(p,g),null!=q&&(i.propagation&&(r=a.extend({},i),delete r.compare,j.validate(p,r)===!1&&(l=!1)),d.util.pushDomContext(n,p,g),l&&(i.format?(k=k||d.util.parseFormat(i.format),q=j.formatter[k[0]].call(j,q,k[1],g),q!==!1&&(h[n]=q)):h[n]=q)))),'this["'+n+'"]'});return l?(d.debug&&f("compare validator pattern:"+m,"compare validator [this] hook:",h),k=new Function("return ("+m+")").call(h),k===!1?(this.sendError("",b,c,g),!1):void 0):!1},cellphone:function(a,b,c){return e.__cellhone||(e.__cellhone=/^1\d{10}$/),d.debug&&f("cellphone regexp:",e.__cellhone),e.__cellhone.test(a)?void 0:(this.sendError("",a,e.__cellhone,c),!1)},email:function(a,b,c){return e.__email||(e.__email=/^[\w._-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+$/),d.debug&&f("email regexp:",e.__email),e.__email.test(a)?void 0:(this.sendError("",a,e.__email,c),!1)},file:function(a,b,c){var g=e[b]||(e[b]=new RegExp("\\.("+b+")$","i"));return d.debug&&f("file regexp:",g),g.test(a)?void 0:(this.sendError("",a,b,c),!1)},remote:function(b,c,e){for(var i,j,g=a.type(c),h={type:"post",async:!1,dataType:"json"};i="function"==g;)c=c.call(null,b,e),g=a.type(c);switch(g){case"string":h.url=c,!i&&e.$dom&&(null==e.name&&(e.name=e.$dom.prop("name")),h.data={},h.data[e.name]=b);break;case"object":a.extend(h,c);break;default:throw"Unexpected remote validator value:"+c}return j=null,h.success=function(a){j=a},d.debug&&f("remote ajax options:",h),a.ajax(h),j?(j.message&&(e.message=j.message,this.sendError("",b,c,e)),j.callback&&window[j.callback].call(e.$dom,j,b,e),"OK"==j.status):!1}},rules:{},define:function(a,b,c){var e,f,h;if(c||(c=!(this instanceof d)),"object"!=typeof a)"object"!=typeof b&&(f={},f[b]=b,b=f),b=this.extendRule(!1,b),h=c?g.rules:this.rules,c||h!==g.rules||(this.rules=h={}),h[a]=b;else for(e in a)g.define.call(this,e,a[e],c)},getRule:function(a){return this.rules[a]||g.rules[a]},validate:function(b,c,e){var h,i,j,k,g=this;if("string"==typeof c&&(c=g.getRule(c),!c))throw"validate rule not found:"+c;if(h=d.context={origin:c},c=h.rule=g.clipRule(c),d.debug&&f("current validate context:",h),b instanceof a){if(!b.length&&!this.strict)return!0;h.$dom=b,b=g.getValue(b,h)}if(h.value=b,c.preMatch){if(c.preMatch.call(g,b,h)===!1)return!0;delete c.preMatch}if(e&&(h.event=e),c.pre){i=g.pre.trimAll(c.pre).split(",");for(j in i)b=g.pre[i[j]].call(g,b,h);h.value=b,delete c.pre}if(null==b&&(h.value=b=""),null!=c.required){if(h.validator="required",g.validator.required.call(g,b,"",h)===!1)return!1;if(h._stop)return!0;delete c.required}if(c.format){if(h.validator="format",b=g.validator.format.call(g,b,c.format,h),b===!1)return!1;if(h._stop)return!0;delete c.format}for(j in c)if(k=g.validator[j]){if(h.validator=j,k.call(g,b,c[j],h)===!1)return!1;if(h._stop)return!0}return!0},execute:function(b,c,d){var f,e=this;return null==d&&(d=c,c=null),b instanceof a||(b=a(b)),b.length?"string"==typeof c?(b.bind(c,function(a){var b="submit"==a.type,c=b?this:a.target,f=b?d:d[c.name];return f?e.execute(c,a,f):!1}),void 0):(f=!0,b.each(function(){var h,b=a(this),g=this.nodeName;if("FORM"==g||"form"==g){for(h in d)if(e.validate(e.$(h,b),c,d[h])===!1)return f=!1}else if(e.validate(b,c,d)===!1)return f=!1}),e.callback&&a.isFunction(e.callback)?e.callback.call(b,f,d,c)!==!1:f):!this.strict},bindAttr:function(b){var c=a.extend({container:"form",eventType:"submit",attr:"v",nameAsValue:!0,cache:!0},b),e=this,g=a(c.container),h=g.find("["+c.attr+"]"),i=function(b,i){var j=b?a(b):c.cache?h:g.find("["+c.attr+"]"),k=!0,l={};return j.each(function(){var b=a(this),h=this.name||b.attr("name"),j=b.attr(c.attr)||c.nameAsValue&&h;if(d.debug&&f("current element ["+j+"] :",b),!j)throw"invalid attribute ["+c.attr+"]:"+b;return l[h]?void 0:(null==this.checked||"radio"!=this.type&&"checkbox"!=this.type||(b=g.find("[name='"+h+"']")),l[h]=j,e.validate(b,j,i)===!1?k=!1:void 0)}),e.callback&&a.isFunction(e.callback)?e.callback.call(j,k,l,i)!==!1:k};return c.eventType&&g.bind(c.eventType,function(a){return i(null,a)}),{validate:i}},sendError:function(b,c,d,e){var f,g;e.trigger=b||e.validator,e.actual=c,e.expected=d,e.label=this.getLabel(e.name,e.$dom,e),f=this.getMessage(e),f!==!1&&(g=a.isFunction(e.rule.renderError)?e.rule.renderError:this.renderError,g.call(this,f,this.$(e.rule.errorFocus)||e.$dom,e))},renderError:function(b,c,d){c&&a.isFunction(c.tips)?c.tips(b):alert(b);var e=d.event;(!e||"focusout"!=e.type&&"blur"!=e.type)&&c&&c.first().focus()},messages:{required:"{label}不能为空!","required.checked":"请先选择{label}!",equalsTo:"{label}必须与{#0}输入一致!","==":"{label}必须等于{expected}!",">=":"{label}必须大于或等于{expected}!",">":"{label}必须大于{expected}!","<=":"{label}必须小于或等于{expected}!","<":"{label}必须小于{expected}!","length.==":"{label}的长度必须等于{expected}!","length.>=":"{label}的长度必须大于或等于{expected}!","length.>":"{label}的长度必须大于{expected}!","length.<=":"{label}的长度必须小于或等于{expected}!","length.<":"{label}的长度必须小于{expected}!","format.number":"{label}必须是有效的整数!","format.number/money":"{label}必须是整数或最多保留两位的小数!","format.number/double":"{label}必须是有效的整数或小数!","format.date":"{label}必须是有效的日期!",file:"{label}的格式不正确，必须为{expected}等格式!","default":"{label}的格式不正确!"},setMessage:function(a,b,c){c||(c=!(this instanceof d));var e=c?g.messages:this.messages;if(c||e!=g.messages||(this.messages=e={}),"object"==typeof a)for(i in a)e[i]=a[i];else e[a]=b},getMessage:function(b){var e,f,h,c=[b.message,b.rule.message,this.messages,g.messages];for(h in c){if(f=e=c[h],e===!1)return f;if(null!=e){if("object"==typeof e&&(f=e[b.validator+"."+b.trigger],null==f&&null==(f=e[b.validator])&&(f=e[b.trigger])),f===!1)return f;if(null!=f)break}}return f&&a.isFunction(f)&&(f=f.call(null,b)),f!==!1&&(f||(f=this.messages["default"]||g.messages["default"]),f&&(f=d.util.parseMessage(f,b,this))),f},labels:{},setLabel:function(a,b,c){c||(c=!(this instanceof d));var e=c?g.labels:this.labels;if(c||e!=g.labels||(this.labels=e={}),"object"==typeof a)for(i in a)e[i]=a[i];else e[a]=b},getLabel:function(a,b){if(a||(a=b.prop("name")),null!=a){var d=this.labels[a]||g.labels[a];if(null==d&&b&&b.length&&(d=b.attr("label")||b.prev("label").text()))return d}return""}},d.util={parseFormat:function(a){var b=a.indexOf("/"),c=[a,""];return b>0&&(c[0]=a.substring(0,b),c[1]=a.substr(b+1)),c},parseIntervalPattern:function(a){if(!e[a]){if(e.__interval||(e.__interval=/^([\[\(])(\d+(\.\d+)?)?(,)?(\d+(\.\d+)?)?([\]\)])$/),!e.__interval.test(a)||!RegExp.$2&&!RegExp.$4)throw"Unexpected interval pattern:"+a;var b={min:RegExp.$2,max:RegExp.$5};RegExp.$4==RegExp.$5?b.equals=!0:(b.left="["==RegExp.$1?">=":">",b.right="]"==RegExp.$7?"<=":"<"),e[a]=b}return e[a]},parseMessage:function(b,c,d){var f=c.$relatedDoms;return b.replace(e.__message||(e.__message=/\{([^}]+)\}/g),function(b,e){var h,i,g=e.charAt(0);return"#"==g||"$"==g?(i=e.substr(1),h=f&&f[i]?d.getLabel(null,f[i],c):d.getLabel(null,a("#"==g?"#"+i:"[name='"+i+"']"),c)):h=c[e],h||(h=""),h})},pushDomContext:function(a,b,c){var d=c.$relatedDoms||(c.$relatedDoms=[]);a||(a=b.prop("name")),d.push(b),a&&(d[a]=b)}},g.define({username:{pre:"trimAll,lower,flush",text:/^[a-z][a-z0-9_]{5,15}$/i,message:"{label}必须是英文、数字和下划线组成的6~16位字符，并且必须以字母开头!"},password:{length:"[6,16]"},age:{format:"number",range:"[18,100]"},"int":{format:"number"},"+int":{format:"number",range:"(0,)"},money:{format:"number/money"},"+money":{format:"number/money",range:"(0,)"},phoneCode:{format:"number",length:"[6]"},imageCode:{length:"[4]"},required:{},cellphone:!0,email:!0,idcard:{format:"idcard/18:[18,]"},file:"jpg|jpeg|gif|png|bmp"}),(b||(b="undefined"!=typeof window?window:this))&&(b.V=d),void 0)}(jQuery,window);